<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- Transmission definitions for DH AG95 gripper -->
  <xacro:macro name="dh_ag95_gripper_transmission" params="prefix">
    
    <!-- ros2_control hardware interface -->
    <ros2_control name="dh_ag95_gripper_hardware" type="system">
      <hardware>
        <plugin>mock_components/GenericSystem</plugin>
        <param name="mock_sensor_commands">false</param>
        <param name="state_following_offset">0.0</param>
      </hardware>
      
      <!-- Finger 1 joint (main actuated joint) -->
      <joint name="${prefix}gripper_finger1_joint">
        <command_interface name="position">
          <param name="min">0.0</param>
          <param name="max">0.65</param>
        </command_interface>
        <state_interface name="position">
          <param name="initial_value">0.0</param>
        </state_interface>
        <state_interface name="velocity">
          <param name="initial_value">0.0</param>
        </state_interface>
      </joint>
      
      <!-- Finger 1 finger joint (passive, mimic) -->
      <joint name="${prefix}gripper_finger1_finger_joint">
        <param name="mimic">${prefix}gripper_finger1_joint</param>
        <param name="multiplier">0.4563942</param>
        <state_interface name="position"/>
        <state_interface name="velocity"/>
      </joint>
      
      <!-- Finger 2 finger joint (passive, mimic) -->
      <joint name="${prefix}gripper_finger2_finger_joint">
        <param name="mimic">${prefix}gripper_finger1_joint</param>
        <param name="multiplier">0.4563942</param>
        <state_interface name="position"/>
        <state_interface name="velocity"/>
      </joint>
      
    </ros2_control>

    <!-- Gazebo ros2_control plugin -->
    <gazebo>
      <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">
        <robot_param>robot_description</robot_param>
        <robot_param_node>robot_state_publisher</robot_param_node>
        <parameters>$(find dh_ag95_gripper)/config/ros2_controllers.yaml</parameters>
      </plugin>
    </gazebo>

  </xacro:macro>

</robot> 